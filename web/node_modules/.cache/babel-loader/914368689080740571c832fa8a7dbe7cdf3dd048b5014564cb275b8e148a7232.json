{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback}from'react';import styled from'styled-components';import{FaDownload,FaImage,FaFile,FaVideo}from'react-icons/fa';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatContainer=styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;const ChatHeader=styled.div`\n  padding: 15px 20px;\n  background: white;\n  border-bottom: 1px solid #e0e0e0;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n`;const Avatar=styled.div`\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: ${props=>props.color||'#0088cc'};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 16px;\n  font-weight: 500;\n`;const ChatInfo=styled.div`\n  flex: 1;\n`;const ChatTitle=styled.div`\n  font-weight: 500;\n  color: #333;\n  margin-bottom: 4px;\n`;const ChatStatus=styled.div`\n  font-size: 14px;\n  color: #666;\n`;const MessagesContainer=styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  background: #f8f9fa;\n`;const MessageGroup=styled.div`\n  margin-bottom: 20px;\n`;const DateSeparator=styled.div`\n  text-align: center;\n  margin: 20px 0;\n  color: #666;\n  font-size: 14px;\n  position: relative;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 0;\n    right: 0;\n    height: 1px;\n    background: #e0e0e0;\n    z-index: 1;\n  }\n  \n  span {\n    background: #f8f9fa;\n    padding: 0 15px;\n    position: relative;\n    z-index: 2;\n  }\n`;const Message=styled.div`\n  display: flex;\n  margin-bottom: 12px;\n  align-items: flex-start;\n  gap: 12px;\n`;const MessageAvatar=styled.div`\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  background: #0088cc;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 12px;\n  font-weight: 500;\n  flex-shrink: 0;\n`;const MessageContent=styled.div`\n  flex: 1;\n  max-width: 70%;\n`;const MessageHeader=styled.div`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n`;const MessageSender=styled.div`\n  font-weight: 500;\n  color: #0088cc;\n  font-size: 14px;\n`;const MessageTime=styled.div`\n  font-size: 12px;\n  color: #999;\n`;const MessageBubble=styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 12px 16px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  word-wrap: break-word;\n  white-space: pre-wrap;\n`;const MediaMessage=styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 12px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  cursor: pointer;\n  \n  &:hover {\n    background: #f8f9fa;\n  }\n`;const MediaIcon=styled.div`\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  background: #e9ecef;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #666;\n`;const MediaInfo=styled.div`\n  flex: 1;\n`;const MediaTitle=styled.div`\n  font-weight: 500;\n  color: #333;\n  margin-bottom: 4px;\n`;const MediaDescription=styled.div`\n  font-size: 14px;\n  color: #666;\n`;const LoadingMessage=styled.div`\n  text-align: center;\n  padding: 20px;\n  color: #666;\n`;const LoadMoreButton=styled.button`\n  width: 100%;\n  padding: 12px;\n  background: #0088cc;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  margin-bottom: 20px;\n  \n  &:hover {\n    background: #0077b5;\n  }\n  \n  &:disabled {\n    background: #ccc;\n    cursor: not-allowed;\n  }\n`;const ChatView=_ref=>{let{conversation}=_ref;const[messages,setMessages]=useState([]);const[loading,setLoading]=useState(true);const[loadingMore,setLoadingMore]=useState(false);const[hasMore,setHasMore]=useState(true);const[offset,setOffset]=useState(0);const messagesEndRef=useRef(null);const offsetRef=useRef(0);// Keep offsetRef in sync with offset state\nuseEffect(()=>{offsetRef.current=offset;},[offset]);const loadMessages=useCallback(async function(){let reset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!conversation)return;const currentOffset=reset?0:offsetRef.current;if(reset){setLoading(true);setMessages([]);setOffset(0);offsetRef.current=0;}else{setLoadingMore(true);}try{const response=await axios.get(`/api/v1/conversations/${conversation.id}/messages`,{params:{limit:50,offset:currentOffset}});const newMessages=response.data.messages||[];if(reset){setMessages(newMessages);setTimeout(()=>scrollToBottom(),100);}else{setMessages(prev=>[...newMessages,...prev]);}const newOffset=currentOffset+newMessages.length;setOffset(newOffset);offsetRef.current=newOffset;setHasMore(newMessages.length===50);}catch(error){console.error('Failed to load messages:',error);}finally{setLoading(false);setLoadingMore(false);}},[conversation]);useEffect(()=>{if(conversation){loadMessages(true);// 设置定时刷新消息 - 每30秒刷新一次\nconst interval=setInterval(()=>{loadMessages(true);},30000);return()=>clearInterval(interval);}},[conversation,loadMessages]);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const formatDate=timestamp=>{const date=new Date(timestamp);const now=new Date();const diffTime=now-date;const diffDays=Math.ceil(diffTime/(1000*60*60*24));if(diffDays===1){return'今天';}else if(diffDays===2){return'昨天';}else if(diffDays<7){return date.toLocaleDateString('zh-CN',{weekday:'long'});}else{return date.toLocaleDateString('zh-CN');}};const formatTime=timestamp=>{const date=new Date(timestamp);return date.toLocaleTimeString('zh-CN',{hour:'2-digit',minute:'2-digit'});};const getInitials=name=>{if(!name)return'?';const words=name.split(' ');if(words.length>=2){return(words[0][0]+words[1][0]).toUpperCase();}return name.substring(0,2).toUpperCase();};const getMediaIcon=messageType=>{switch(messageType){case'photo':return/*#__PURE__*/_jsx(FaImage,{});case'video':return/*#__PURE__*/_jsx(FaVideo,{});case'document':return/*#__PURE__*/_jsx(FaFile,{});default:return/*#__PURE__*/_jsx(FaFile,{});}};const renderMessage=message=>{const isMedia=message.message_type!=='text';// 构建发送者显示名称，优先显示昵称+用户名组合\nlet senderName='';const fullName=message.from_first_name?`${message.from_first_name} ${message.from_last_name||''}`.trim():'';const username=message.from_username;if(fullName&&username){// 有昵称和用户名：显示 \"昵称 (@用户名)\"\nsenderName=`${fullName} (@${username})`;}else if(fullName){// 只有昵称：显示 \"昵称\"\nsenderName=fullName;}else if(username){// 只有用户名：显示 \"@用户名\"\nsenderName=`@${username}`;}else{// 都没有：显示 \"未知用户\"\nsenderName='未知用户';}return/*#__PURE__*/_jsxs(Message,{children:[/*#__PURE__*/_jsx(MessageAvatar,{children:getInitials(senderName)}),/*#__PURE__*/_jsxs(MessageContent,{children:[/*#__PURE__*/_jsxs(MessageHeader,{children:[/*#__PURE__*/_jsx(MessageSender,{children:senderName}),/*#__PURE__*/_jsx(MessageTime,{children:formatTime(message.timestamp)})]}),isMedia?/*#__PURE__*/_jsxs(MediaMessage,{onClick:()=>message.media_url&&window.open(message.media_url),children:[/*#__PURE__*/_jsx(MediaIcon,{children:getMediaIcon(message.message_type)}),/*#__PURE__*/_jsxs(MediaInfo,{children:[/*#__PURE__*/_jsx(MediaTitle,{children:message.content}),/*#__PURE__*/_jsx(MediaDescription,{children:message.message_type})]}),/*#__PURE__*/_jsx(FaDownload,{})]}):/*#__PURE__*/_jsx(MessageBubble,{children:message.content})]})]},`${message.id}-${message.message_id}`);};const groupMessagesByDate=messages=>{const groups={};messages.forEach(message=>{const date=new Date(message.timestamp).toDateString();if(!groups[date]){groups[date]=[];}groups[date].push(message);});return Object.entries(groups).map(_ref2=>{let[date,messages]=_ref2;return{date,messages:messages.sort((a,b)=>new Date(a.timestamp)-new Date(b.timestamp))};});};if(loading){return/*#__PURE__*/_jsx(ChatContainer,{children:/*#__PURE__*/_jsx(LoadingMessage,{children:\"\\u52A0\\u8F7D\\u6D88\\u606F\\u4E2D...\"})});}const messageGroups=groupMessagesByDate(messages);return/*#__PURE__*/_jsxs(ChatContainer,{children:[/*#__PURE__*/_jsxs(ChatHeader,{children:[/*#__PURE__*/_jsx(Avatar,{color:\"#0088cc\",children:getInitials(conversation.title)}),/*#__PURE__*/_jsxs(ChatInfo,{children:[/*#__PURE__*/_jsx(ChatTitle,{children:conversation.title}),/*#__PURE__*/_jsxs(ChatStatus,{children:[conversation.username&&`@${conversation.username} • `,conversation.type==='user'&&'用户',conversation.type==='bot'&&'机器人',conversation.type==='group'&&'群组',conversation.type==='channel'&&'频道']})]})]}),/*#__PURE__*/_jsxs(MessagesContainer,{children:[hasMore&&/*#__PURE__*/_jsx(LoadMoreButton,{onClick:()=>loadMessages(false),disabled:loadingMore,children:loadingMore?'加载中...':'加载更多消息'}),messageGroups.map(_ref3=>{let{date,messages}=_ref3;return/*#__PURE__*/_jsxs(MessageGroup,{children:[/*#__PURE__*/_jsx(DateSeparator,{children:/*#__PURE__*/_jsx(\"span\",{children:formatDate(messages[0].timestamp)})}),messages.map(renderMessage)]},date);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})]});};export default ChatView;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","styled","FaDownload","FaImage","FaFile","FaVideo","axios","jsx","_jsx","jsxs","_jsxs","ChatContainer","div","ChatHeader","Avatar","props","color","ChatInfo","ChatTitle","ChatStatus","MessagesContainer","MessageGroup","DateSeparator","Message","MessageAvatar","MessageContent","MessageHeader","MessageSender","MessageTime","MessageBubble","MediaMessage","MediaIcon","MediaInfo","MediaTitle","MediaDescription","LoadingMessage","LoadMoreButton","button","ChatView","_ref","conversation","messages","setMessages","loading","setLoading","loadingMore","setLoadingMore","hasMore","setHasMore","offset","setOffset","messagesEndRef","offsetRef","current","loadMessages","reset","arguments","length","undefined","currentOffset","response","get","id","params","limit","newMessages","data","setTimeout","scrollToBottom","prev","newOffset","error","console","interval","setInterval","clearInterval","_messagesEndRef$curre","scrollIntoView","behavior","formatDate","timestamp","date","Date","now","diffTime","diffDays","Math","ceil","toLocaleDateString","weekday","formatTime","toLocaleTimeString","hour","minute","getInitials","name","words","split","toUpperCase","substring","getMediaIcon","messageType","renderMessage","message","isMedia","message_type","senderName","fullName","from_first_name","from_last_name","trim","username","from_username","children","onClick","media_url","window","open","content","message_id","groupMessagesByDate","groups","forEach","toDateString","push","Object","entries","map","_ref2","sort","a","b","messageGroups","title","type","disabled","_ref3","ref"],"sources":["/Users/zhangshijie/Documents/web3Task/tgBackup/web/src/components/ChatView.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport styled from 'styled-components';\nimport { FaDownload, FaImage, FaFile, FaVideo } from 'react-icons/fa';\nimport axios from 'axios';\n\nconst ChatContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nconst ChatHeader = styled.div`\n  padding: 15px 20px;\n  background: white;\n  border-bottom: 1px solid #e0e0e0;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n`;\n\nconst Avatar = styled.div`\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: ${props => props.color || '#0088cc'};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 16px;\n  font-weight: 500;\n`;\n\nconst ChatInfo = styled.div`\n  flex: 1;\n`;\n\nconst ChatTitle = styled.div`\n  font-weight: 500;\n  color: #333;\n  margin-bottom: 4px;\n`;\n\nconst ChatStatus = styled.div`\n  font-size: 14px;\n  color: #666;\n`;\n\nconst MessagesContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  background: #f8f9fa;\n`;\n\nconst MessageGroup = styled.div`\n  margin-bottom: 20px;\n`;\n\nconst DateSeparator = styled.div`\n  text-align: center;\n  margin: 20px 0;\n  color: #666;\n  font-size: 14px;\n  position: relative;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 0;\n    right: 0;\n    height: 1px;\n    background: #e0e0e0;\n    z-index: 1;\n  }\n  \n  span {\n    background: #f8f9fa;\n    padding: 0 15px;\n    position: relative;\n    z-index: 2;\n  }\n`;\n\nconst Message = styled.div`\n  display: flex;\n  margin-bottom: 12px;\n  align-items: flex-start;\n  gap: 12px;\n`;\n\nconst MessageAvatar = styled.div`\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  background: #0088cc;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-size: 12px;\n  font-weight: 500;\n  flex-shrink: 0;\n`;\n\nconst MessageContent = styled.div`\n  flex: 1;\n  max-width: 70%;\n`;\n\nconst MessageHeader = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n`;\n\nconst MessageSender = styled.div`\n  font-weight: 500;\n  color: #0088cc;\n  font-size: 14px;\n`;\n\nconst MessageTime = styled.div`\n  font-size: 12px;\n  color: #999;\n`;\n\nconst MessageBubble = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 12px 16px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  word-wrap: break-word;\n  white-space: pre-wrap;\n`;\n\nconst MediaMessage = styled.div`\n  background: white;\n  border-radius: 12px;\n  padding: 12px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  cursor: pointer;\n  \n  &:hover {\n    background: #f8f9fa;\n  }\n`;\n\nconst MediaIcon = styled.div`\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  background: #e9ecef;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #666;\n`;\n\nconst MediaInfo = styled.div`\n  flex: 1;\n`;\n\nconst MediaTitle = styled.div`\n  font-weight: 500;\n  color: #333;\n  margin-bottom: 4px;\n`;\n\nconst MediaDescription = styled.div`\n  font-size: 14px;\n  color: #666;\n`;\n\nconst LoadingMessage = styled.div`\n  text-align: center;\n  padding: 20px;\n  color: #666;\n`;\n\nconst LoadMoreButton = styled.button`\n  width: 100%;\n  padding: 12px;\n  background: #0088cc;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  margin-bottom: 20px;\n  \n  &:hover {\n    background: #0077b5;\n  }\n  \n  &:disabled {\n    background: #ccc;\n    cursor: not-allowed;\n  }\n`;\n\nconst ChatView = ({ conversation }) => {\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMore, setHasMore] = useState(true);\n  const [offset, setOffset] = useState(0);\n  const messagesEndRef = useRef(null);\n  const offsetRef = useRef(0);\n\n  // Keep offsetRef in sync with offset state\n  useEffect(() => {\n    offsetRef.current = offset;\n  }, [offset]);\n\n  const loadMessages = useCallback(async (reset = false) => {\n    if (!conversation) return;\n    \n    const currentOffset = reset ? 0 : offsetRef.current;\n    \n    if (reset) {\n      setLoading(true);\n      setMessages([]);\n      setOffset(0);\n      offsetRef.current = 0;\n    } else {\n      setLoadingMore(true);\n    }\n\n    try {\n      const response = await axios.get(`/api/v1/conversations/${conversation.id}/messages`, {\n        params: {\n          limit: 50,\n          offset: currentOffset\n        }\n      });\n\n      const newMessages = response.data.messages || [];\n      \n      if (reset) {\n        setMessages(newMessages);\n        setTimeout(() => scrollToBottom(), 100);\n      } else {\n        setMessages(prev => [...newMessages, ...prev]);\n      }\n\n      const newOffset = currentOffset + newMessages.length;\n      setOffset(newOffset);\n      offsetRef.current = newOffset;\n      setHasMore(newMessages.length === 50);\n      \n    } catch (error) {\n      console.error('Failed to load messages:', error);\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, [conversation]);\n\n  useEffect(() => {\n    if (conversation) {\n      loadMessages(true);\n      \n      // 设置定时刷新消息 - 每30秒刷新一次\n      const interval = setInterval(() => {\n        loadMessages(true);\n      }, 30000);\n      \n      return () => clearInterval(interval);\n    }\n  }, [conversation, loadMessages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const formatDate = (timestamp) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diffTime = now - date;\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n    if (diffDays === 1) {\n      return '今天';\n    } else if (diffDays === 2) {\n      return '昨天';\n    } else if (diffDays < 7) {\n      return date.toLocaleDateString('zh-CN', { weekday: 'long' });\n    } else {\n      return date.toLocaleDateString('zh-CN');\n    }\n  };\n\n  const formatTime = (timestamp) => {\n    const date = new Date(timestamp);\n    return date.toLocaleTimeString('zh-CN', { \n      hour: '2-digit', \n      minute: '2-digit' \n    });\n  };\n\n  const getInitials = (name) => {\n    if (!name) return '?';\n    const words = name.split(' ');\n    if (words.length >= 2) {\n      return (words[0][0] + words[1][0]).toUpperCase();\n    }\n    return name.substring(0, 2).toUpperCase();\n  };\n\n  const getMediaIcon = (messageType) => {\n    switch (messageType) {\n      case 'photo':\n        return <FaImage />;\n      case 'video':\n        return <FaVideo />;\n      case 'document':\n        return <FaFile />;\n      default:\n        return <FaFile />;\n    }\n  };\n\n  const renderMessage = (message) => {\n    const isMedia = message.message_type !== 'text';\n    // 构建发送者显示名称，优先显示昵称+用户名组合\n    let senderName = '';\n    const fullName = message.from_first_name ? \n      `${message.from_first_name} ${message.from_last_name || ''}`.trim() : '';\n    const username = message.from_username;\n    \n    if (fullName && username) {\n      // 有昵称和用户名：显示 \"昵称 (@用户名)\"\n      senderName = `${fullName} (@${username})`;\n    } else if (fullName) {\n      // 只有昵称：显示 \"昵称\"\n      senderName = fullName;\n    } else if (username) {\n      // 只有用户名：显示 \"@用户名\"\n      senderName = `@${username}`;\n    } else {\n      // 都没有：显示 \"未知用户\"\n      senderName = '未知用户';\n    }\n\n    return (\n      <Message key={`${message.id}-${message.message_id}`}>\n        <MessageAvatar>\n          {getInitials(senderName)}\n        </MessageAvatar>\n        <MessageContent>\n          <MessageHeader>\n            <MessageSender>{senderName}</MessageSender>\n            <MessageTime>{formatTime(message.timestamp)}</MessageTime>\n          </MessageHeader>\n          \n          {isMedia ? (\n            <MediaMessage onClick={() => message.media_url && window.open(message.media_url)}>\n              <MediaIcon>\n                {getMediaIcon(message.message_type)}\n              </MediaIcon>\n              <MediaInfo>\n                <MediaTitle>{message.content}</MediaTitle>\n                <MediaDescription>{message.message_type}</MediaDescription>\n              </MediaInfo>\n              <FaDownload />\n            </MediaMessage>\n          ) : (\n            <MessageBubble>\n              {message.content}\n            </MessageBubble>\n          )}\n        </MessageContent>\n      </Message>\n    );\n  };\n\n  const groupMessagesByDate = (messages) => {\n    const groups = {};\n    \n    messages.forEach(message => {\n      const date = new Date(message.timestamp).toDateString();\n      if (!groups[date]) {\n        groups[date] = [];\n      }\n      groups[date].push(message);\n    });\n\n    return Object.entries(groups).map(([date, messages]) => ({\n      date,\n      messages: messages.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp))\n    }));\n  };\n\n  if (loading) {\n    return (\n      <ChatContainer>\n        <LoadingMessage>加载消息中...</LoadingMessage>\n      </ChatContainer>\n    );\n  }\n\n  const messageGroups = groupMessagesByDate(messages);\n\n  return (\n    <ChatContainer>\n      <ChatHeader>\n        <Avatar color=\"#0088cc\">\n          {getInitials(conversation.title)}\n        </Avatar>\n        <ChatInfo>\n          <ChatTitle>{conversation.title}</ChatTitle>\n          <ChatStatus>\n            {conversation.username && `@${conversation.username} • `}\n            {conversation.type === 'user' && '用户'}\n            {conversation.type === 'bot' && '机器人'}\n            {conversation.type === 'group' && '群组'}\n            {conversation.type === 'channel' && '频道'}\n          </ChatStatus>\n        </ChatInfo>\n      </ChatHeader>\n\n      <MessagesContainer>\n        {hasMore && (\n          <LoadMoreButton \n            onClick={() => loadMessages(false)}\n            disabled={loadingMore}\n          >\n            {loadingMore ? '加载中...' : '加载更多消息'}\n          </LoadMoreButton>\n        )}\n\n        {messageGroups.map(({ date, messages }) => (\n          <MessageGroup key={date}>\n            <DateSeparator>\n              <span>{formatDate(messages[0].timestamp)}</span>\n            </DateSeparator>\n            {messages.map(renderMessage)}\n          </MessageGroup>\n        ))}\n        \n        <div ref={messagesEndRef} />\n      </MessagesContainer>\n    </ChatContainer>\n  );\n};\n\nexport default ChatView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}